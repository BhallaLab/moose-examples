<?xml version="1.0" encoding="UTF-8"?>
<sbml xmlns="http://www.sbml.org/sbml/level3/version1/core" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:moose="http://www.moose.ncbs.res.in" xmlns:groups="http://www.sbml.org/sbml/level3/version1/groups/version1" level="3" version="1" groups:required="false">
  <model id="chanPhosph3compt" substanceUnits="substance" timeUnits="time" volumeUnits="volume" areaUnits="area" lengthUnits="length" extentUnits="substance">
    <annotation>
      <moose:ModelAnnotation>
        <moose:runTime> 100.0 </moose:runTime>
        <moose:solver> ee </moose:solver>
        <moose:simdt>0.01 </moose:simdt>
        <moose:plotdt> 1.0 </moose:plotdt>
        <moose:plots/>
      </moose:ModelAnnotation>
    </annotation>
    <listOfUnitDefinitions>
      <unitDefinition id="volume">
        <listOfUnits>
          <unit kind="litre" exponent="1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="substance">
        <listOfUnits>
          <unit kind="mole" exponent="1" scale="-3" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="length">
        <listOfUnits>
          <unit kind="metre" exponent="1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="area">
        <listOfUnits>
          <unit kind="metre" exponent="2" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="time">
        <listOfUnits>
          <unit kind="second" exponent="1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="per_second">
        <listOfUnits>
          <unit kind="second" exponent="-1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="sq_litre_per_mmole_sq_per_second">
        <listOfUnits>
          <unit kind="litre" exponent="2" scale="0" multiplier="1"/>
          <unit kind="mole" exponent="-2" scale="-3" multiplier="1"/>
          <unit kind="second" exponent="-1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
      <unitDefinition id="litre_per_mmole_per_second">
        <listOfUnits>
          <unit kind="litre" exponent="1" scale="0" multiplier="1"/>
          <unit kind="mole" exponent="-1" scale="-3" multiplier="1"/>
          <unit kind="second" exponent="-1" scale="0" multiplier="1"/>
        </listOfUnits>
      </unitDefinition>
    </listOfUnitDefinitions>
    <listOfCompartments>
      <compartment id="kinetics_473_0_" name="kinetics" spatialDimensions="3" size="1e-15" units="volume" constant="true">
        <annotation>
          <moose:CompartmentAnnotation>
            <moose:Mesh>CubeMesh</moose:Mesh>
            <moose:isMembraneBound>False</moose:isMembraneBound>
          </moose:CompartmentAnnotation>
        </annotation>
      </compartment>
      <compartment id="compartment_1_518_0_" name="compartment_1" spatialDimensions="3" size="1e-16" units="volume" constant="true">
        <annotation>
          <moose:CompartmentAnnotation>
            <moose:Mesh>CubeMesh</moose:Mesh>
            <moose:isMembraneBound>False</moose:isMembraneBound>
          </moose:CompartmentAnnotation>
        </annotation>
      </compartment>
      <compartment id="compartment_2_520_0_" name="compartment_2" spatialDimensions="3" size="1e-17" units="volume" constant="true">
        <annotation>
          <moose:CompartmentAnnotation>
            <moose:Mesh>CubeMesh</moose:Mesh>
            <moose:isMembraneBound>False</moose:isMembraneBound>
          </moose:CompartmentAnnotation>
        </annotation>
      </compartment>
    </listOfCompartments>
    <listOfSpecies>
      <species id="Ca_CaM_CaMKII_482_0_" name="Ca_CaM_CaMKII" compartment="compartment_2_520_0_" initialConcentration="0" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>857.1428571428571</moose:xCord>
            <moose:yCord>80.0</moose:yCord>
            <moose:bgColor>blue</moose:bgColor>
            <moose:textColor>yellow</moose:textColor>
            <moose:diffConstant>0.0</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="kinase_cplx_485_0_" name="kinase_cplx" compartment="compartment_2_520_0_" initialConcentration="0" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>857.1428571428571</moose:xCord>
            <moose:yCord>170.0</moose:yCord>
            <moose:bgColor>white</moose:bgColor>
            <moose:textColor>black</moose:textColor>
            <moose:diffConstant>0.0</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="chan_487_0_" name="chan" compartment="compartment_2_520_0_" initialConcentration="0.1" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>714.2857142857143</moose:xCord>
            <moose:yCord>400.0</moose:yCord>
            <moose:bgColor>0</moose:bgColor>
            <moose:textColor>yellow</moose:textColor>
            <moose:diffConstant>0.0</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="chan_p_491_0_" name="chan_p" compartment="compartment_2_520_0_" initialConcentration="0" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>1000.0</moose:xCord>
            <moose:yCord>400.0</moose:yCord>
            <moose:bgColor>7</moose:bgColor>
            <moose:textColor>yellow</moose:textColor>
            <moose:diffConstant>0.0</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="CaM_495_0_" name="CaM" compartment="compartment_1_518_0_" initialConcentration="0.01" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>0.0</moose:xCord>
            <moose:yCord>640.0</moose:yCord>
            <moose:bgColor>55</moose:bgColor>
            <moose:textColor>0</moose:textColor>
            <moose:diffConstant>1e-11</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="Ca_497_0_" name="Ca" compartment="compartment_1_518_0_" initialConcentration="8e-05" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>285.7142857142857</moose:xCord>
            <moose:yCord>800.0</moose:yCord>
            <moose:bgColor>blue</moose:bgColor>
            <moose:textColor>0</moose:textColor>
            <moose:diffConstant>1e-10</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="Ca_CaM_499_0_" name="Ca_CaM" compartment="compartment_1_518_0_" initialConcentration="0" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>428.57142857142856</moose:xCord>
            <moose:yCord>400.0</moose:yCord>
            <moose:bgColor>blue</moose:bgColor>
            <moose:textColor>0</moose:textColor>
            <moose:diffConstant>1e-11</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="CaMKII_503_0_" name="CaMKII" compartment="compartment_1_518_0_" initialConcentration="0.00833333333333333" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>142.85714285714286</moose:xCord>
            <moose:yCord>240.0</moose:yCord>
            <moose:bgColor>7</moose:bgColor>
            <moose:textColor>0</moose:textColor>
            <moose:diffConstant>0.0</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
      <species id="Ca_509_0_" name="Ca" compartment="kinetics_473_0_" initialConcentration="8e-05" substanceUnits="substance" hasOnlySubstanceUnits="false" boundaryCondition="false" constant="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>285.7142857142857</moose:xCord>
            <moose:yCord>0.0</moose:yCord>
            <moose:bgColor>blue</moose:bgColor>
            <moose:textColor>35</moose:textColor>
            <moose:diffConstant>1e-10</moose:diffConstant>
            <moose:motorConstant>0.0</moose:motorConstant>
          </moose:ModelAnnotation>
        </annotation>
      </species>
    </listOfSpecies>
    <listOfReactions>
      <reaction id="dephosph_489_0_" name="dephosph" reversible="false" fast="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>857.1428571428571</moose:xCord>
            <moose:yCord>560.0</moose:yCord>
            <moose:bgColor>white</moose:bgColor>
            <moose:textColor>yellow</moose:textColor>
          </moose:ModelAnnotation>
        </annotation>
        <listOfReactants>
          <speciesReference species="chan_p_491_0_" stoichiometry="1" constant="false"/>
        </listOfReactants>
        <listOfProducts>
          <speciesReference species="chan_487_0_" stoichiometry="1" constant="false"/>
        </listOfProducts>
        <kineticLaw>
          <notes>
            <body xmlns="http://www.w3.org/1999/xhtml">
		compartment_2_520_0_ * dephosph_489_0__Kf * chan_p_491_0_
 	 </body>
          </notes>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> compartment_2_520_0_ </ci>
              <ci> dephosph_489_0__Kf </ci>
              <ci> chan_p_491_0_ </ci>
            </apply>
          </math>
          <listOfLocalParameters>
            <localParameter id="dephosph_489_0__Kf" value="1" units="per_second"/>
          </listOfLocalParameters>
        </kineticLaw>
      </reaction>
      <reaction id="Ca_bind_CaM_501_0_" name="Ca_bind_CaM" reversible="true" fast="false">
        <notes>
          <body xmlns="http://www.w3.org/1999/xhtml">
 	 	This should actually be 4th order in Ca. Using 2nd order here for simplicity and to lessen numerical stiffness.
	 </body>
        </notes>
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>142.85714285714286</moose:xCord>
            <moose:yCord>480.0</moose:yCord>
            <moose:bgColor>white</moose:bgColor>
            <moose:textColor>0</moose:textColor>
          </moose:ModelAnnotation>
        </annotation>
        <listOfReactants>
          <speciesReference species="CaM_495_0_" stoichiometry="1" constant="false"/>
          <speciesReference species="Ca_497_0_" stoichiometry="2" constant="false"/>
        </listOfReactants>
        <listOfProducts>
          <speciesReference species="Ca_CaM_499_0_" stoichiometry="1" constant="false"/>
        </listOfProducts>
        <kineticLaw>
          <notes>
            <body xmlns="http://www.w3.org/1999/xhtml">
		compartment_1_518_0_ * Ca_bind_CaM_501_0__Kf * CaM_495_0_*Ca_497_0_^2-compartment_1_518_0_ * Ca_bind_CaM_501_0__Kb * Ca_CaM_499_0_
 	 </body>
          </notes>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <minus/>
              <apply>
                <times/>
                <ci> compartment_1_518_0_ </ci>
                <ci> Ca_bind_CaM_501_0__Kf </ci>
                <ci> CaM_495_0_ </ci>
                <apply>
                  <power/>
                  <ci> Ca_497_0_ </ci>
                  <cn type="integer"> 2 </cn>
                </apply>
              </apply>
              <apply>
                <times/>
                <ci> compartment_1_518_0_ </ci>
                <ci> Ca_bind_CaM_501_0__Kb </ci>
                <ci> Ca_CaM_499_0_ </ci>
              </apply>
            </apply>
          </math>
          <listOfLocalParameters>
            <localParameter id="Ca_bind_CaM_501_0__Kf" value="10000080" units="sq_litre_per_mmole_sq_per_second"/>
            <localParameter id="Ca_bind_CaM_501_0__Kb" value="40" units="per_second"/>
          </listOfLocalParameters>
        </kineticLaw>
      </reaction>
      <reaction id="CaM_bind_CaMKII_505_0_" name="CaM_bind_CaMKII" reversible="true" fast="false">
        <annotation>
          <moose:ModelAnnotation>
            <moose:xCord>428.57142857142856</moose:xCord>
            <moose:yCord>160.0</moose:yCord>
            <moose:bgColor>white</moose:bgColor>
            <moose:textColor>0</moose:textColor>
          </moose:ModelAnnotation>
        </annotation>
        <listOfReactants>
          <speciesReference species="Ca_CaM_499_0_" stoichiometry="1" constant="false"/>
          <speciesReference species="CaMKII_503_0_" stoichiometry="1" constant="false"/>
        </listOfReactants>
        <listOfProducts>
          <speciesReference species="Ca_CaM_CaMKII_482_0_" stoichiometry="1" constant="false"/>
        </listOfProducts>
        <kineticLaw>
          <notes>
            <body xmlns="http://www.w3.org/1999/xhtml">
		compartment_1_518_0_ * CaM_bind_CaMKII_505_0__Kf * Ca_CaM_499_0_*CaMKII_503_0_-compartment_1_518_0_ * CaM_bind_CaMKII_505_0__Kb * Ca_CaM_CaMKII_482_0_
 	 </body>
          </notes>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <minus/>
              <apply>
                <times/>
                <ci> compartment_1_518_0_ </ci>
                <ci> CaM_bind_CaMKII_505_0__Kf </ci>
                <ci> Ca_CaM_499_0_ </ci>
                <ci> CaMKII_503_0_ </ci>
              </apply>
              <apply>
                <times/>
                <ci> compartment_1_518_0_ </ci>
                <ci> CaM_bind_CaMKII_505_0__Kb </ci>
                <ci> Ca_CaM_CaMKII_482_0_ </ci>
              </apply>
            </apply>
          </math>
          <listOfLocalParameters>
            <localParameter id="CaM_bind_CaMKII_505_0__Kf" value="100.002" units="litre_per_mmole_per_second"/>
            <localParameter id="CaM_bind_CaMKII_505_0__Kb" value="0.1" units="per_second"/>
          </listOfLocalParameters>
        </kineticLaw>
      </reaction>
      <reaction id="kinase_484_0_Complex_formation_" name="kinase" reversible="true" fast="false">
        <annotation>
          <moose:EnzymaticReaction>
            <moose:enzyme>Ca_CaM_CaMKII_482_0_</moose:enzyme>
            <moose:substrates>chan_487_0_</moose:substrates>
            <moose:product>kinase_cplx_485_0_</moose:product>
            <moose:groupName>kinase_484_0_</moose:groupName>
            <moose:stage>1</moose:stage>
            <moose:xCord>857.1428571428571</moose:xCord>
            <moose:yCord>160.0</moose:yCord>
            <moose:bgColor>red</moose:bgColor>
            <moose:textColor>blue</moose:textColor>
          </moose:EnzymaticReaction>
        </annotation>
        <listOfReactants>
          <speciesReference species="Ca_CaM_CaMKII_482_0_" stoichiometry="1" constant="false"/>
          <speciesReference species="chan_487_0_" stoichiometry="1" constant="false"/>
        </listOfReactants>
        <listOfProducts>
          <speciesReference species="kinase_cplx_485_0_" stoichiometry="1" constant="false"/>
        </listOfProducts>
        <kineticLaw>
          <notes>
            <body xmlns="http://www.w3.org/1999/xhtml">
		compartment_2_520_0_ * ( k1 * Ca_CaM_CaMKII_482_0_*chan_487_0_ -  k2  * kinase_cplx_485_0_ )
 	 </body>
          </notes>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> compartment_2_520_0_ </ci>
              <apply>
                <minus/>
                <apply>
                  <times/>
                  <ci> k1 </ci>
                  <ci> Ca_CaM_CaMKII_482_0_ </ci>
                  <ci> chan_487_0_ </ci>
                </apply>
                <apply>
                  <times/>
                  <ci> k2 </ci>
                  <ci> kinase_cplx_485_0_ </ci>
                </apply>
              </apply>
            </apply>
          </math>
          <listOfLocalParameters>
            <localParameter id="k1" value="996.343244342565" units="litre_per_mmole_per_second"/>
            <localParameter id="k2" value="8" units="per_second"/>
          </listOfLocalParameters>
        </kineticLaw>
      </reaction>
      <reaction id="kinase_484_0_Product_formation_" name="kinase" reversible="false" fast="false">
        <annotation>
          <moose:EnzymaticReaction>
            <moose:complex>kinase_cplx_485_0_</moose:complex>
            <moose:enzyme>Ca_CaM_CaMKII_482_0_</moose:enzyme>
            <moose:product>chan_p_491_0_</moose:product>
            <moose:groupName>kinase_484_0_</moose:groupName>
            <moose:stage>2</moose:stage>
            <moose:xCord>857.1428571428571</moose:xCord>
            <moose:yCord>160.0</moose:yCord>
            <moose:bgColor>red</moose:bgColor>
            <moose:textColor>blue</moose:textColor>
          </moose:EnzymaticReaction>
        </annotation>
        <listOfReactants>
          <speciesReference species="kinase_cplx_485_0_" stoichiometry="1" constant="false"/>
        </listOfReactants>
        <listOfProducts>
          <speciesReference species="chan_p_491_0_" stoichiometry="1" constant="false"/>
          <speciesReference species="Ca_CaM_CaMKII_482_0_" stoichiometry="1" constant="false"/>
        </listOfProducts>
        <kineticLaw>
          <notes>
            <body xmlns="http://www.w3.org/1999/xhtml">
		compartment_2_520_0_ * k3*kinase_cplx_485_0_
 	 </body>
          </notes>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> compartment_2_520_0_ </ci>
              <ci> k3 </ci>
              <ci> kinase_cplx_485_0_ </ci>
            </apply>
          </math>
          <listOfLocalParameters>
            <localParameter id="k3" value="2" units="per_second"/>
          </listOfLocalParameters>
        </kineticLaw>
      </reaction>
    </listOfReactions>
    <groups:listOfGroups>
      <groups:group groups:id="PSD_480_0_" groups:name="PSD" groups:kind="collection">
        <annotation>
          <moose:GroupAnnotation>
            <moose:Compartment>kinetics_473_0_</moose:Compartment>
            <moose:Parent>kinetics_473_0_</moose:Parent>
            <moose:bgColor>#FFFF00</moose:bgColor>
          </moose:GroupAnnotation>
        </annotation>
      </groups:group>
      <groups:group groups:id="SPINE_493_0_" groups:name="SPINE" groups:kind="collection">
        <annotation>
          <moose:GroupAnnotation>
            <moose:Compartment>kinetics_473_0_</moose:Compartment>
            <moose:Parent>kinetics_473_0_</moose:Parent>
            <moose:bgColor>#f800ff</moose:bgColor>
          </moose:GroupAnnotation>
        </annotation>
      </groups:group>
      <groups:group groups:id="DEND_507_0_" groups:name="DEND" groups:kind="collection">
        <annotation>
          <moose:GroupAnnotation>
            <moose:Compartment>kinetics_473_0_</moose:Compartment>
            <moose:Parent>kinetics_473_0_</moose:Parent>
            <moose:bgColor>#38ff00</moose:bgColor>
          </moose:GroupAnnotation>
        </annotation>
        <groups:listOfMembers>
          <groups:member groups:idRef="Ca_509_0_"/>
        </groups:listOfMembers>
      </groups:group>
    </groups:listOfGroups>
  </model>
</sbml>
